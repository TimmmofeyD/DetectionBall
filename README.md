
# Детекция и отслеживание мяча в футболе с использованием YOLO

## Введение

Задача детекции мяча на футбольном поле является ключевой для анализа спортивных видео, особенно матчей по футболу. Реальное время для обнаружения и отслеживания мяча может быть крайне важным для создания автоматических систем анализа матчей, которые помогают тренерам, командам и аналитикам извлекать полезную информацию для улучшения тактики игры и проведения статистического анализа. Данная проблема имеет несколько сложностей, таких как динамика игры, изменяющиеся условия освещения, наличие множества игроков и движение камеры.

## Проблематика

Одной из главных сложностей этой задачи является то, что мяч является небольшим объектом, который может быть скрыт игроками, пересекаться с линиями поля и двигаться на большой скорости. Различные углы съемки и изменения освещения дополнительно усложняют процесс обнаружения и отслеживания. Мяч также может находиться в воздухе или отскакивать от различных поверхностей, что затрудняет предсказание его движения на основе предыдущих кадров.

Использование YOLO и других современных архитектур для детекции объектов значительно улучшает точность обнаружения и отслеживания мяча в условиях реальных матчей, где постоянно разворачиваются сложные динамические сцены.

## Обзор ноутбуков

### `download_data.ipynb`
- **Назначение:** Этот ноутбук используется для загрузки датасета SoccerNet, включающего данные для задачи gamestate-2024.
- **Основные шаги:**
  1. Загрузка данных SoccerNet (тренировочный, валидационный, тестовый и челлендж-сплиты) с помощью `SoccerNetDownloader`.
  2. Сохранение данных в локальной директории для дальнейшей обработки.

### `preprocessing_data.ipynb`
- **Назначение:** Этот ноутбук фокусируется на предварительной обработке загруженных изображений и аннотаций.
- **Основные шаги:**
  1. Нормализация координат ограничивающих рамок в формат YOLO.
  2. Изменение размера изображений до целевого (640x384).
  3. Обработка аннотаций для соответствия новым размерам изображений и обеспечения правильного формата для обучения YOLO.

### `fill_empty.ipynb`
- **Назначение:** Этот ноутбук используется для проверки наличия аннотаций для каждого изображения.
- **Основные шаги:**
  1. Проверка на наличие отсутствующих файлов аннотаций.
  2. Создание пустых файлов аннотаций для изображений, не имеющих аннотаций.

### `display_checking.ipynb`
- **Назначение:** Этот ноутбук позволяет визуально проверять аннотации, наложенные на изображения.
- **Основные шаги:**
  1. Загрузка изображения и соответствующих аннотаций.
  2. Конвертация аннотаций в формате YOLO обратно в координаты изображения.
  3. Отображение изображения с ограничивающими рамками для проверки корректности аннотаций.

### `soccernet_model.ipynb`
- **Назначение:** Этот ноутбук фокусируется на обучении и развертывании модели YOLO для детекции и отслеживания мяча в видеозаписях футбольных матчей.
- **Основные шаги:**
  1. Обучение модели YOLO с использованием данных SoccerNet с различными методами аугментации, такими как перевороты, масштабирование, трансляция, mixup и мозаика.
  2. Отслеживание мяча на последовательности видеокадров.
  3. Визуализация истории обнаружений, рисуя траекторию движения мяча по кадрам.
  4. Сохранение итогового видео с аннотированной траекторией.

## Установка зависимостей

1. Склонируйте репозиторий или скачайте файлы проекта.
2. Установите необходимые зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Загрузите датасет SoccerNet, используя `download_data.ipynb`.

## Обучение модели

Чтобы обучить модель YOLO, следуйте шагам в `soccernet_model.ipynb`. Модель предварительно обучена, но может быть дообучена на данных SoccerNet для улучшения детекции мяча.

## Результаты

После обучения модель YOLO может эффективно обнаруживать и отслеживать мяч в режиме реального времени на видеозаписях матчей. Движение мяча отслеживается по кадрам, и его траектория визуализируется.

## Заключение

Этот проект демонстрирует мощь современных методов детекции объектов, таких как YOLO, для решения сложных задач видеоанализа, таких как детекция мяча в футболе. Используя методы аугментации данных и дообучение, можно достичь высокой точности даже в сложных сценариях.
